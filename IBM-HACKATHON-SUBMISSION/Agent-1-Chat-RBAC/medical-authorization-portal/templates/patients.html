{% extends "base.html" %}

{% block title %}Patient Search - Medical Authorization Portal{% endblock %}

{% block extra_css %}
<style>
    .search-box {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 30px;
    }
    
    .search-title {
        font-size: 16px;
        font-weight: 600;
        color: white;
        margin-bottom: 15px;
    }
    
    .search-form {
        display: grid;
        grid-template-columns: 1fr 1fr auto;
        gap: 15px;
        align-items: flex-end;
    }
    
    .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .form-label {
        font-size: 13px;
        font-weight: 600;
        color: white;
    }
    
    .form-input {
        background: #111;
        border: 1px solid #333;
        color: white;
        padding: 12px;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s;
    }
    
    .form-input:focus {
        outline: none;
        border-color: #4a90e2;
        box-shadow: 0 0 12px rgba(74,144,226,0.3);
    }
    
    .search-btn {
        background: linear-gradient(135deg, #4a90e2, #3a80d2);
        border: none;
        color: white;
        padding: 12px 25px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
        white-space: nowrap;
    }
    
    .search-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(74,144,226,0.4);
    }
    
    .results-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 20px;
    }
    
    .patient-card {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 12px;
        padding: 20px;
        transition: all 0.3s;
    }
    
    .patient-card:hover {
        border-color: #4a90e2;
        box-shadow: 0 8px 24px rgba(74,144,226,0.2);
    }
    
    .patient-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 15px;
    }
    
    .patient-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, #4a90e2, #3a80d2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        flex-shrink: 0;
    }
    
    .patient-info {
        flex: 1;
    }
    
    .patient-name {
        font-size: 16px;
        font-weight: 600;
        color: white;
        margin: 0;
    }
    
    .patient-id {
        font-size: 12px;
        color: #9ca3af;
        margin: 4px 0 0 0;
    }
    
    .patient-details {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin: 15px 0;
        padding: 12px 0;
        border-top: 1px solid #333;
        border-bottom: 1px solid #333;
    }
    
    .detail-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
    }
    
    .detail-label {
        color: #9ca3af;
    }
    
    .detail-value {
        color: white;
        font-weight: 600;
    }
    
    .member-status {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
    }
    
    .status-active {
        background: rgba(40,167,69,0.2);
        color: #20c997;
    }
    
    .status-inactive {
        background: rgba(220,53,69,0.2);
        color: #ff6b6b;
    }
    
    .patient-actions {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
    }
    
    .action-btn {
        background: #4a90e2;
        border: none;
        color: white;
        padding: 10px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        transition: all 0.3s;
    }
    
    .action-btn:hover {
        background: #3a80d2;
        transform: translateY(-2px);
    }
    
    .action-btn-secondary {
        background: #555;
    }
    
    .action-btn-secondary:hover {
        background: #666;
    }
    
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #9ca3af;
    }
    
    .empty-icon {
        font-size: 64px;
        margin-bottom: 15px;
    }
    
    .loading-card {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 12px;
        padding: 20px;
    }
    
    .loading-line {
        background: linear-gradient(90deg, #222 25%, #333 50%, #222 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
        height: 20px;
        border-radius: 4px;
        margin-bottom: 12px;
    }
    
    .loading-line:last-child {
        margin-bottom: 0;
    }
    
    @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }
    
    @media (max-width: 768px) {
        .search-form {
            grid-template-columns: 1fr;
        }
        
        .results-container {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">üë• Patient Search</h1>
    <p class="page-subtitle">Find and manage patient medical records</p>
</div>

<!-- Search Box -->
<div class="search-box">
    <div class="search-title">Search Patient</div>
    <form class="search-form" onsubmit="searchPatients(event)">
        <div class="form-group">
            <label class="form-label">Member Number / ID</label>
            <input 
                type="text" 
                class="form-input" 
                id="search-member" 
                placeholder="e.g., MEM123456"
                autocomplete="off"
            >
        </div>
        
        <div class="form-group">
            <label class="form-label">Patient Name</label>
            <input 
                type="text" 
                class="form-input" 
                id="search-name" 
                placeholder="e.g., John Doe"
                autocomplete="off"
            >
        </div>
        
        <button type="submit" class="search-btn">
            üîç Search
        </button>
    </form>
</div>

<!-- Results -->
<div id="results-container" class="results-container">
    <div class="empty-state">
        <div class="empty-icon">üë•</div>
        <p>Enter search criteria above to find patients</p>
        <p style="font-size: 12px; color: #6b7280;">Search by member number or patient name</p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    const samplePatients = [
        {
            id: 'PT-001',
            name: 'John Doe',
            memberNumber: 'MEM123456',
            dob: '1975-05-15',
            age: 49,
            scheme: 'Premium Health',
            status: 'active',
            phone: '+1-555-0101'
        },
        {
            id: 'PT-002',
            name: 'Jane Smith',
            memberNumber: 'MEM123457',
            dob: '1982-08-22',
            age: 42,
            scheme: 'Standard Plan',
            status: 'active',
            phone: '+1-555-0102'
        },
        {
            id: 'PT-003',
            name: 'Bob Wilson',
            memberNumber: 'MEM123458',
            dob: '1960-03-10',
            age: 64,
            scheme: 'Senior Care',
            status: 'active',
            phone: '+1-555-0103'
        },
        {
            id: 'PT-004',
            name: 'Alice Johnson',
            memberNumber: 'MEM123459',
            dob: '1995-11-30',
            age: 28,
            scheme: 'Basic Health',
            status: 'inactive',
            phone: '+1-555-0104'
        },
        {
            id: 'PT-005',
            name: 'Charlie Brown',
            memberNumber: 'MEM123460',
            dob: '1988-07-12',
            age: 36,
            scheme: 'Family Plan',
            status: 'active',
            phone: '+1-555-0105'
        }
    ];
    
    function searchPatients(event) {
        event.preventDefault();
        
        const memberSearch = document.getElementById('search-member').value.toLowerCase();
        const nameSearch = document.getElementById('search-name').value.toLowerCase();
        
        let results = samplePatients;
        
        if (memberSearch) {
            results = results.filter(p => p.memberNumber.toLowerCase().includes(memberSearch));
        }
        
        if (nameSearch) {
            results = results.filter(p => p.name.toLowerCase().includes(nameSearch));
        }
        
        displayResults(results);
    }
    
    function displayResults(patients) {
        const container = document.getElementById('results-container');
        
        if (patients.length === 0) {
            container.innerHTML = `
                <div style="grid-column: 1 / -1;">
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <p>No patients found matching your search</p>
                    </div>
                </div>
            `;
            return;
        }
        
        container.innerHTML = patients.map(patient => {
            const statusClass = patient.status === 'active' ? 'status-active' : 'status-inactive';
            const statusText = patient.status.charAt(0).toUpperCase() + patient.status.slice(1);
            
            return `
                <div class="patient-card">
                    <div class="patient-header">
                        <div class="patient-avatar">${patient.name.charAt(0)}</div>
                        <div class="patient-info">
                            <p class="patient-name">${patient.name}</p>
                            <p class="patient-id">ID: ${patient.id}</p>
                        </div>
                    </div>
                    
                    <div class="patient-details">
                        <div class="detail-row">
                            <span class="detail-label">Member #:</span>
                            <span class="detail-value">${patient.memberNumber}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Age:</span>
                            <span class="detail-value">${patient.age} years</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Scheme:</span>
                            <span class="detail-value">${patient.scheme}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status:</span>
                            <span class="member-status ${statusClass}">${statusText}</span>
                        </div>
                    </div>
                    
                    <div class="patient-actions">
                        <button class="action-btn" onclick="viewPatientDetails('${patient.id}')">
                            üëÅÔ∏è View Details
                        </button>
                        <button class="action-btn action-btn-secondary" onclick="createAuthorization('${patient.id}')">
                            üìã New Auth
                        </button>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    function viewPatientDetails(patientId) {
        alert(`Viewing details for patient ${patientId}`);
    }
    
    function createAuthorization(patientId) {
        alert(`Creating authorization for patient ${patientId}`);
    }
</script>
{% endblock %}
